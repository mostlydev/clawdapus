services:
  openclaw:
    image: ${OPENCLAW_IMAGE:-clawdapus-openclaw:latest}
    build:
      context: ./runner
      dockerfile: Dockerfile
      args:
        OPENCLAW_NPM_PACKAGE: ${OPENCLAW_NPM_PACKAGE:-openclaw@2026.2.9}
    restart: unless-stopped
    environment:
      TZ: ${TZ:-UTC}
      OPENCLAW_STATE_DIR: /state/openclaw
      OPENCLAW_CONFIG_PATH: /state/openclaw/openclaw.json
      OPENCLAW_WORKSPACE_DIR: /workspace
      OPENCLAW_AUTO_SETUP: ${OPENCLAW_AUTO_SETUP:-1}
      OPENCLAW_HEARTBEAT_EVERY: ${OPENCLAW_HEARTBEAT_EVERY:-30m}
      OPENCLAW_HEARTBEAT_TARGET: ${OPENCLAW_HEARTBEAT_TARGET:-none}
      OPENCLAW_HEARTBEAT_PROMPT: ${OPENCLAW_HEARTBEAT_PROMPT:-}
      OPENCLAW_MODEL_PRIMARY: ${OPENCLAW_MODEL_PRIMARY:-}
      OPENCLAW_GATEWAY_AUTH_TOKEN: ${OPENCLAW_GATEWAY_AUTH_TOKEN:-}
      OPENCLAW_GATEWAY_PORT: ${OPENCLAW_GATEWAY_PORT:-18789}
      OPENCLAW_GATEWAY_BIND_MODE: ${OPENCLAW_GATEWAY_BIND_MODE:-loopback}
      ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY:-}
      OPENAI_API_KEY: ${OPENAI_API_KEY:-}
      OPENROUTER_API_KEY: ${OPENROUTER_API_KEY:-}
      GEMINI_API_KEY: ${GEMINI_API_KEY:-}
      VOYAGE_API_KEY: ${VOYAGE_API_KEY:-}
      BRAVE_API_KEY: ${BRAVE_API_KEY:-}
      POLYMARKET_PRIVATE_KEY: ${POLYMARKET_PRIVATE_KEY:-}
      PRIVATE_KEY: ${POLYMARKET_PRIVATE_KEY:-}
      POLYMARKET_SIGNATURE_TYPE: ${POLYMARKET_SIGNATURE_TYPE:-}
      POLYMARKET_FUNDER_ADDRESS: ${POLYMARKET_FUNDER_ADDRESS:-}
      POLYMARKET_API_KEY: ${POLYMARKET_API_KEY:-}
      POLYMARKET_API_SECRET: ${POLYMARKET_API_SECRET:-}
      POLYMARKET_API_PASSPHRASE: ${POLYMARKET_API_PASSPHRASE:-}
      POLYMARKET_HOST: ${POLYMARKET_HOST:-https://clob.polymarket.com}
      POLYMARKET_CHAIN_ID: ${POLYMARKET_CHAIN_ID:-137}
      POLYMARKET_SYNC_OUTPUT: /workspace/state/balance.json
      POLYMARKET_SYNC_CREDS_CACHE: /workspace/state/polymarket_l2_creds.json
      POLYMARKET_SYNC_CACHE_DERIVED_CREDS: ${POLYMARKET_SYNC_CACHE_DERIVED_CREDS:-1}
      POLYMARKET_SYNC_BURN_USD_PER_HOUR: ${POLYMARKET_SYNC_BURN_USD_PER_HOUR:-0}
      POLY_OPPORTUNITIES_OUTPUT: /workspace/state/opportunities.json
      POLY_OPPORTUNITIES_FILE: /workspace/state/opportunities.json
      POLY_TRADES_LOG: /workspace/state/trades.json
      POLY_TRADES_FILE: /workspace/state/trades.json
      POLY_POSITIONS_FILE: /workspace/state/positions.json
      POLYMARKET_CREDS_FILE: /workspace/state/polymarket_l2_creds.json
      POLY_MIN_EDGE_EXECUTE: ${POLY_MIN_EDGE_EXECUTE:-0.01}
      POLY_MAX_POSITION_USD: ${POLY_MAX_POSITION_USD:-10}
      POLY_MIN_SHARES_PER_LEG: ${POLY_MIN_SHARES_PER_LEG:-5}
      POLY_SCAN_MARKET_LIMIT: ${POLY_SCAN_MARKET_LIMIT:-250}
      POLY_SCAN_MIN_EDGE: ${POLY_SCAN_MIN_EDGE:-0.0025}
      POLY_SCAN_CONCURRENCY: ${POLY_SCAN_CONCURRENCY:-16}
      POLY_SCAN_RESULTS_LIMIT: ${POLY_SCAN_RESULTS_LIMIT:-50}
      POLY_SCAN_MULTI_TOKEN: ${POLY_SCAN_MULTI_TOKEN:-0}
    volumes:
      - type: bind
        source: ${BOT_REPO_PATH:-.}
        target: /workspace
      - type: bind
        source: ${AGENTS_FILE_PATH:-./workspaces/default/AGENTS.md}
        target: /workspace/AGENTS.md
        read_only: true
      - type: bind
        source: ${BOT_STATE_PATH:-./runtime/default}
        target: /state
      - type: bind
        source: ${BOT_STATE_PATH:-./runtime/default}/openclaw/openclaw.json
        target: /state/openclaw/openclaw.json
        read_only: true
